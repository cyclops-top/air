# Proposal: 实现 S3 兼容服务器 (独立端口)

## Why
在之前的尝试中，我们发现使用路径前缀（如 `/_s3/`）在同一端口提供 S3 服务会导致潜在的文件名冲突（例如无法下载名为 `_s3` 的文件）。为了提供最彻底的兼容性并避免任何路径冲突，本提案建议将 S3 兼容服务运行在独立于 Web UI 的另一个端口上。

## What Changes
- **独立端口运行**: S3 服务将绑定到与 Web UI 不同的端口。
- **CLI 参数扩展**: 
    - 新增 `--s3-port <u16>` 参数，允许手动指定 S3 服务端口。
    - 如果未指定，则采用与主端口类似的自动随机选择逻辑。
- **S3 协议集成**: 引入 `s3s` 协议栈，实现核心 S3 操作（ListObjectsV2, GetObject, HeadObject）。
- **TUI 增强**: 在仪表盘中同时展示 Web UI 地址和 S3 API Endpoint 地址。
- **并发服务**: 服务器将同时运行两个独立的 TCP/HTTPS 监听任务。

## Impact
- **零冲突**: 彻底解决文件名与 API 路径冲突的问题。
- **专业集成**: 允许客户端以标准的 `http://ip:s3_port` 作为 Endpoint 访问，无需路径偏移。
- **资源利用**: 额外占用一个端口，但换取了更高的稳定性和一致性。
