# Proposal: 实现 S3 兼容服务器入口 (单端口)

## Why
虽然 `Air` 提供了极简的 Web UI，但在专业的工作流中，用户往往希望使用成熟的客户端（如 rclone, Cyberduck, AWS CLI）来管理或挂载远程文件系统。通过支持 S3 协议，`Air` 可以被这些工具识别为一个标准的对象存储服务，极大扩展了其集成能力。

## What Changes
- **协议栈集成**: 引入 `s3s` crate，在现有的 Axum 服务中嵌入 S3 协议处理逻辑。
- **单端口共存**: 在同一端口上同时提供 Web UI 和 S3 API。
- **冲突规避逻辑**: 
    - 为了避免文件名（如名为 "S3" 的文件）与 API 路径冲突，我们将 S3 API 挂载在特定的**路径前缀**下（例如 `/_s3/`）。
    - S3 客户端通过 `http://ip:port/_s3` 作为 Endpoint 进行访问。
- **匿名访问**: 在局域网模式下默认允许匿名 S3 访问，同时也预留 AccessKey/SecretKey 的配置接口。
- **核心动作映射**: 
    - `ListObjectsV2` -> 映射到本地目录扫描。
    - `GetObject` -> 映射到本地文件读取（利用已有的 Range/Digest 逻辑）。

## Impact
- **互操作性**: `Air` 分享的目录可以被挂载为本地磁盘或通过专业存储客户端管理。
- **稳定性**: 使用成熟的 S3 协议栈，减少了自定义 XML 处理的负担。
